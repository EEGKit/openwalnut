stages:
        - initialJobs
        - stylecheck_doc
        - test
        - testDebug

init1:
        stage: initialJobs
        cache:
                key: "CacheRelease"
                paths:
                        - build/release
        script:
                - echo "Init1 job output"
                - mkdir -p build
                - cd build
                - mkdir -p release
                - cd release
                - cmake ../../src -DCMAKE_BUILD_TYPE=Release
                - exit 0
init2:
        stage: initialJobs
        script:
                - echo "Init2 job output"
                - exit 1
        allow_failure: true

stylecheck_doc_job:
        stage: stylecheck_doc
        cache:
                key: "CacheRelease"
                paths:
                        - build/release
        script:
                - ls
                - mkdir -p build
                - cd build
                - ls
                - mkdir -p release
                - ls
                - make stylecheck
                - make doc

buildAndTest:
        stage: test
        cache:
                key: "CacheRelease"
                paths:
                        - build/release
        script:
                - pwd
                - mkdir -p build
                - cd build
                - mkdir -p release
                - cd release
                - cmake ../../src -DCMAKE_BUILD_TYPE=Release
                - make -j 8
                - make vtest
                
buildAndTestDebug:
        stage: testDebug
        cache:
                key: "CacheDebug"
                paths:
                        - build/debug
        script:
                - pwd
                - mkdir -p build
                - cd build
                - mkdir -p debug
                - cd debug
                - cmake ../../src -DCMAKE_BUILD_TYPE=Debug
                - make -j 8
                - make vtest
